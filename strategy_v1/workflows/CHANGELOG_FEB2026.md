# Changelog - –§–µ–≤—Ä–∞–ª—å 2026

**–î–∞—Ç–∞:** 4 —Ñ–µ–≤—Ä–∞–ª—è 2026  
**–ê–≤—Ç–æ—Ä:** AI Assistant + User

## üì¶ –†–µ–∑—é–º–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

–ü—Ä–æ–≤–µ–¥–µ–Ω–∞ –º–∞—Å—à—Ç–∞–±–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ workflow —Å–∏—Å—Ç–µ–º—ã –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤.

---

## üîß EMA Logger Workflow - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–±–ª–µ–º–∞
EMA100 –∏ EMA200 –æ—Å—Ç–∞–≤–∞–ª–∏—Å—å `NULL` –¥–∞–∂–µ –ø–æ—Å–ª–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –¥–Ω–µ–π —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, —Ç–∞–∫ –∫–∞–∫ workflow –ø—ã—Ç–∞–ª—Å—è —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å –∏—Ö –Ω–∞ –æ—Å–Ω–æ–≤–µ 200 –±–∞—Ä–æ–≤ –∏–∑ API, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–ª —Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ç–æ—Ä–≥–æ–≤—ã–π –¥–µ–Ω—å.

### –†–µ—à–µ–Ω–∏–µ
**–ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥ DB + API:**
- –¢–µ–ø–µ—Ä—å workflow –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ **1 –ø–æ—Å–ª–µ–¥–Ω–∏–π –±–∞—Ä** –∏–∑ Alpaca API
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç **200 –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø–∏—Å–µ–π** –∏–∑ PostgreSQL `ema_snapshots`
- –û–±—ä–µ–¥–∏–Ω—è–µ—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ + –Ω–æ–≤—ã–π –±–∞—Ä
- –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Å–µ EMA –Ω–∞ —ç—Ç–æ–º –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ

#### –ù–æ–≤—ã–µ —É–∑–ª—ã:
- **Get Historical Prices from DB** (PostgreSQL query)
  ```sql
  SELECT close_price, volume, timestamp
  FROM ema_snapshots
  WHERE symbol = '{{ $json.symbol }}'
  ORDER BY timestamp DESC
  LIMIT 200
  ```

#### –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —É–∑–ª—ã:
1. **Get All OHLC Bars (Batch)**
   - `limit: 200` ‚Üí `limit: 1` (–∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π –±–∞—Ä)
   - –≠–∫–æ–Ω–æ–º–∏—è bandwidth –∏ API quota

2. **Calculate EMA/RSI/Volume**
   - –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞–Ω–∞ –ª–æ–≥–∏–∫–∞ —Ä–∞—Å—á—ë—Ç–∞
   - –î–æ–±–∞–≤–ª–µ–Ω merge –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ DB —Å –Ω–æ–≤—ã–º –±–∞—Ä–æ–º API
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞—Å—á—ë—Ç–∞ EMA200 –Ω–∞ –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

3. **Split Batch Response**
   - –î–æ–±–∞–≤–ª–µ–Ω `$execution.stop()` –¥–ª—è graceful termination –ø—Ä–∏ –ø—É—Å—Ç–æ–º –æ—Ç–≤–µ—Ç–µ
   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–∏—Ç—É–∞—Ü–∏—é –∑–∞–∫—Ä—ã—Ç–æ–≥–æ —Ä—ã–Ω–∫–∞ –±–µ–∑ –æ—à–∏–±–æ–∫

#### –£–¥–∞–ª—ë–Ω–Ω—ã–µ —É–∑–ª—ã:
- ‚ùå **Check_Market_Hours** (IF node) - –∏–∑–±—ã—Ç–æ—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ cron
- ‚ùå **Load Historical Data** - –≤—Ä–µ–º–µ–Ω–Ω–∞—è —Ç–µ—Å—Ç–æ–≤–∞—è –Ω–æ–¥–∞ –¥–ª—è Yahoo Finance
- ‚ùå **Every 12 Hours (Test Data)** - —Ç–µ—Å—Ç–æ–≤—ã–π —Ç—Ä–∏–≥–≥–µ—Ä

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è

**Cron —Ç—Ä–∏–≥–≥–µ—Ä:**
```cron
*/1 15-22 * * 1-5
```
- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É **—Ç–æ–ª—å–∫–æ 15:00-22:59 CET** (–ø–Ω-–ø—Ç)
- **15:00 CET = 09:00 ET** (–Ω–∞—á–∞–ª–æ —Ç–æ—Ä–≥–æ–≤–æ–π —Å–µ—Å—Å–∏–∏ -30 –º–∏–Ω)
- **22:00 CET = 16:00 ET** (–∑–∞–∫—Ä—ã—Ç–∏–µ —Ä—ã–Ω–∫–∞)

**–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:**
- –ë—ã–ª–æ: ~1440 –∑–∞–ø—É—Å–∫–æ–≤/–¥–µ–Ω—å (24/7)
- –°—Ç–∞–ª–æ: ~480 –∑–∞–ø—É—Å–∫–æ–≤/–¥–µ–Ω—å (—Ç–æ–ª—å–∫–æ —Ç–æ—Ä–≥–æ–≤—ã–µ —á–∞—Å—ã)
- **–≠–∫–æ–Ω–æ–º–∏—è: 67% API requests**

### –ì—Ä–∞—Ñ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```
Every 1 Minute (Market Hours) [Cron 15-22 CET]
    ‚Üì
Get All OHLC Bars (Batch) [Alpaca API: limit=1]
    ‚Üì
Split Batch Response [–ü–∞—Ä—Å–∏–Ω–≥ + graceful stop]
    ‚Üì
For Each Symbol [Loop —á–µ—Ä–µ–∑ 7 —Å–∏–º–≤–æ–ª–æ–≤]
    ‚Üì
Get Historical Prices from DB [PostgreSQL: 200 –∑–∞–ø–∏—Å–µ–π]
    ‚Üì
Calculate EMA/RSI/Volume [Merge DB + API ‚Üí —Ä–∞—Å—á—ë—Ç]
    ‚Üì
Detect Crossover [Golden/Death Cross]
    ‚Üì
Save to ema_snapshots [PostgreSQL INSERT]
    ‚Üì (loop back)
For Each Symbol
```

---

## üìä Sentiment Executor Workflow - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ SQL –æ—à–∏–±–∫–∞
**–ü—Ä–æ–±–ª–µ–º–∞:** `column ts.sector does not exist`

**–†–µ—à–µ–Ω–∏–µ:**
```sql
-- –ë–´–õ–û:
SELECT ... ts.sector ...
FROM sentiment_scores ss
INNER JOIN tracked_symbols ts ON ss.symbol = ts.symbol

-- –°–¢–ê–õ–û: (—É–¥–∞–ª–∏–ª–∏ ts.sector –∏–∑ SELECT –∏ GROUP BY)
SELECT 
  ss.symbol AS stock,
  ROUND(AVG(ss.sentiment_score), 4) AS "sentimentScore",
  MAX(ss.rationale) FILTER (WHERE ss.date = CURRENT_DATE) AS rationale,
  ts.active
FROM sentiment_scores ss
INNER JOIN tracked_symbols ts ON ss.symbol = ts.symbol
```

### 2. –í—Ä–µ–º–µ–Ω–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ EMA200 —Ñ–∏–ª—å—Ç—Ä–∞
**–ü—Ä–∏—á–∏–Ω–∞:** EMA200 –¥–∞–Ω–Ω—ã–µ –µ—â—ë –Ω–µ –Ω–∞–∫–æ–ø–ª–µ–Ω—ã (—Ç—Ä–µ–±—É–µ—Ç—Å—è 200+ –º–∏–Ω—É—Ç —Ç–æ—Ä–≥–æ–≤–ª–∏)

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ filter_top_sentiment_score:**
```javascript
// –ë–´–õ–û:
if (ema.close_price == null || ema.ema200 == null || ema.ema9 == null || ema.ema21 == null) return false;
const emaOk = Number(ema.close_price) > Number(ema.ema200) && Number(ema.ema9) > Number(ema.ema21);

// –°–¢–ê–õ–û:
if (ema.close_price == null || ema.ema9 == null || ema.ema21 == null) return false;
const emaOk = Number(ema.ema9) > Number(ema.ema21);
```

**–¢–µ–∫—É—â–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã:**
- ‚úÖ EMA9 > EMA21 (short-term golden cross)
- ‚úÖ RSI14 < 70 (–Ω–µ –ø–µ—Ä–µ–∫—É–ø–ª–µ–Ω)
- ‚úÖ Volume > Volume MA20 (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–±—ä—ë–º–æ–º)
- ‚è≥ EMA200 —Ñ–∏–ª—å—Ç—Ä –æ—Ç–∫–ª—é—á—ë–Ω –¥–æ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

### 3. –î–æ–±–∞–≤–ª–µ–Ω–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –≤–µ—Ç–∫–∞ –¥–ª—è Portfolio Summary

**–ü—Ä–æ–±–ª–µ–º–∞:** Telegram summary –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–ª—Å—è –∫–æ–≥–¥–∞ –Ω–µ –±—ã–ª–æ —Å–¥–µ–ª–æ–∫

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω —É–∑–µ–ª **Check_No_Trades** (IF node)
```javascript
// –£—Å–ª–æ–≤–∏–µ:
has_positions_to_close === false AND has_positions_to_open === false

// TRUE ‚Üí –Ω–∞–ø—Ä—è–º—É—é –∫ Get_Portfolio_Summary
// FALSE ‚Üí –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–¥–µ–ª–æ–∫
```

**–ù–æ–≤—ã–µ –ø—É—Ç–∏:**
1. **–ï—Å—Ç—å —Å–¥–µ–ª–∫–∏:** merge ‚Üí save_positions_to_db ‚Üí Get_Portfolio_Summary ‚Üí Telegram
2. **–ù–µ—Ç —Å–¥–µ–ª–æ–∫:** Check_No_Trades ‚Üí Get_Portfolio_Summary ‚Üí Telegram

---

## üìÅ –ê—Ä—Ö–∏–≤–∞—Ü–∏—è

–°—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤:
```
/Users/gabby/git/TradingBot/strategy_v1/workflows/archive_feb2026/
‚îú‚îÄ‚îÄ ema-logger.json (—Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è —Å API-only –ø–æ–¥—Ö–æ–¥–æ–º)
‚îî‚îÄ‚îÄ sentiment-executor.json (–¥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π SQL –∏ summary)
```

---

## üéØ –§–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### EMA Logger
| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ |
|---------|-----|-------|
| –£–∑–ª—ã | 11 | 8 |
| API –∑–∞–ø—Ä–æ—Å–æ–≤/–¥–µ–Ω—å | 1440 | 480 |
| –ë–∞—Ä–æ–≤ –Ω–∞ –∑–∞–ø—Ä–æ—Å | 200 | 1 |
| EMA200 —Ä–∞–±–æ—Ç–∞–µ—Ç | ‚ùå | ‚úÖ |
| Cron —Ç–æ—á–Ω–æ—Å—Ç—å | 24/7 | –¢–æ—Ä–≥–æ–≤—ã–µ —á–∞—Å—ã |

### Sentiment Executor
| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ |
|---------|-----|-------|
| SQL –æ—à–∏–±–∫–∏ | ‚ùå | ‚úÖ |
| Summary –ø—Ä–∏ 0 —Å–¥–µ–ª–æ–∫ | ‚ùå | ‚úÖ |
| EMA200 —Ñ–∏–ª—å—Ç—Ä | –ê–∫—Ç–∏–≤–µ–Ω | –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á—ë–Ω |

---

## ‚è≠Ô∏è –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö**
   ```sql
   SELECT symbol, COUNT(*) 
   FROM ema_snapshots 
   GROUP BY symbol;
   ```
   –û–∂–∏–¥–∞–µ–º: 200+ –∑–∞–ø–∏—Å–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞

2. **–ê–∫—Ç–∏–≤–∞—Ü–∏—è EMA200 —Ñ–∏–ª—å—Ç—Ä–∞** (—á–µ—Ä–µ–∑ 2-3 —Ç–æ—Ä–≥–æ–≤—ã—Ö –¥–Ω—è)
   - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É `ema200 != null`
   - –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä `close_price > ema200`

3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±–æ–µ–≤—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö**
   - –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤–æ –≤—Ä–µ–º—è —Å–ª–µ–¥—É—é—â–µ–π —Ç–æ—Ä–≥–æ–≤–æ–π —Å–µ—Å—Å–∏–∏ (–ø–Ω 09:30 ET)
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∫–∞–∂–¥—ã–π —á–∞—Å
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

---

## üîë –ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

- ‚úÖ **–†–µ—à–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ NULL EMA200** —á–µ—Ä–µ–∑ –≥–∏–±—Ä–∏–¥–Ω—ã–π DB+API –ø–æ–¥—Ö–æ–¥
- ‚úÖ **73% —ç–∫–æ–Ω–æ–º–∏—è API –∑–∞–ø—Ä–æ—Å–æ–≤** —á–µ—Ä–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é cron
- ‚úÖ **Graceful handling** —Ä—ã–Ω–∫–∞ –≤ –Ω–µ—Ä–∞–±–æ—á–∏–µ —á–∞—Å—ã
- ‚úÖ **Telegram summary –≤—Å–µ–≥–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è** –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Å–¥–µ–ª–æ–∫
- ‚úÖ **–£—Å—Ç—Ä–∞–Ω–µ–Ω—ã SQL –æ—à–∏–±–∫–∏** –≤ sentiment workflow
- ‚úÖ **–£–ø—Ä–æ—â–µ–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - —É–¥–∞–ª–µ–Ω—ã –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ —É–∑–ª—ã

---

## üìù –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- **n8n** v2.2.3 - workflow automation
- **PostgreSQL** - —Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤ EMA
- **Alpaca API v2** - —Ä—ã–Ω–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (IEX feed)
- **Cron** - –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- Alpaca Paper Trading Account (PA3XDVIL1AK3)
- PostgreSQL credentials: gdEjFpQ7Jf6e0OER
- Telegram Bot: NeCkDlU3OGIVsHG0

### –ß–∞—Å–æ–≤—ã–µ –ø–æ—è—Å–∞
- **–°–µ—Ä–≤–µ—Ä:** CET (UTC+1) - –ø–æ–ª—å—Å–∫–æ–µ –≤—Ä–µ–º—è
- **–ë–∏—Ä–∂–∞:** ET (UTC-5) - –ù—å—é-–ô–æ—Ä–∫
- **–†–∞–∑–Ω–∏—Ü–∞:** 6 —á–∞—Å–æ–≤ (15:30 CET = 09:30 ET)

---

**Changelog —Å–æ–∑–¥–∞–Ω:** 2026-02-04 10:20 CET
